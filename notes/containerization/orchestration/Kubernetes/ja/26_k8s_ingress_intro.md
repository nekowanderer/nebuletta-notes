# Kubernetes Ingress 入門ガイド

[English](../en/26_k8s_ingress_intro.md) | [繁體中文](../zh-tw/26_k8s_ingress_intro.md) | [日本語](../ja/26_k8s_ingress_intro.md) | [インデックスに戻る](../README.md)

```
  ┌─────────────────────────────────────────────────────────────────────────┐
  │                                Cluster                                  │
  │  ┌─────────────┐                                                        │
  │  │  Service A  │                                                        │
  │  │ ┌───┐ ┌───┐ │    all.demo.com/beta                                   │
  │  │ │Pod│ │Pod│ │ ←─────┐                                                │
  │  │ └───┘ └───┘ │       │                                                │
  │  └─────────────┘       │                                                │
  │                        │                                                │
  │                        │    ┌─────────┐   ┌────────────────────┐        │
  │                        └─── │         │   │                    │        │
  │                             │ Ingress │ ← │ Ingress Controller │        │
  │                        ┌─── │         │   │                    │        │
  │                        │    └─────────┘   └────────────────────┘        │
  │                        │                           ↑                    │
  │  ┌─────────────┐       │                           │                    │
  │  │  Service B  │       │                  ┌─────────────────┐           │
  │  │ ┌───┐ ┌───┐ │ ←─────┘                  │  Load Balancer  │ ←── User  │
  │  │ │Pod│ │Pod│ │    all.demo.com/prod     └─────────────────┘           │
  │  │ └───┘ └───┘ │                                                        │
  │  └─────────────┘                                                        │
  └─────────────────────────────────────────────────────────────────────────┘
```

### Kubernetes Ingress とは

Kubernetes Ingress は、クラスタ内のサービスへの外部アクセスを管理するAPIオブジェクトです。HTTPおよびHTTPSトラフィックの単一エントリポイントとして機能し、ホスト名、パス、その他の条件に基づいてトラフィックを異なるサービスにルーティングするルールを提供します。

### 基本的な Ingress アーキテクチャ

基本的な Ingress 設定は、いくつかの重要なコンポーネントで構成されています：

- **Ingress リソース**：ルーティングルールを定義
- **Ingress Controller**：実際のルーティングロジックを実装
- **ロードバランサー**：トラフィックの外部エントリポイント
- **サービス**：ルーティングされたトラフィックを受信するバックエンドサービス

```
外部ユーザー → ロードバランサー → Ingress Controller → Ingress → サービス → Pod
```

### デフォルトバックエンドを使用した単一サービスルーティング

最もシンプルな構成では、Ingress はすべてのトラフィックを単一のサービスに転送できます：

- 外部リクエストがロードバランサーを通じて入ってくる
- Ingress Controller がリクエストを処理
- すべてのトラフィックが**デフォルトバックエンド**サービスにルーティングされる
- サービスが関連するPod（Service A に複数のPod）にトラフィックを転送

この設定は、複雑なルーティングルールを必要としないシンプルなアプリケーションに適しています。

### ホストベースのマルチサービスルーティング

Ingress は異なるホスト名に基づいて異なるサービスにルーティングできます：

- **all.demo.com/beta** は Service A にルーティング
- **all.demo.com/prod** は Service B にルーティング

各サービスは独自のPodセットを維持し、以下を可能にします：
- 環境の分離（ベータ版 vs 本番版）
- サービスの独立したスケーリング
- 同一ドメイン内でのパスベースルーティング

### Ingress Controller オプション

**クラウドプロバイダーソリューション：**
- **AWS ALB**（Application Load Balancer）
- **GCP Load Balancer** 
- **Azure Application Gateway**

**セルフマネージドソリューション：**
- **Local Nginx** - 最も一般的なオープンソースオプション

Ingress Controller の選択は以下に依存します：
- インフラストラクチャプラットフォーム（クラウド vs オンプレミス）
- 機能要件（SSL終端、認証など）
- パフォーマンスとコストの考慮事項

### Ingress 使用の主な利点

- **単一エントリポイント**：一つのインターフェースを通じて外部アクセスを統合
- **コスト効率**：複数のLoadBalancerサービスの必要性を削減
- **高度なルーティング**：ホストベースおよびパスベースのルーティングをサポート
- **SSL終端**：HTTPS証明書を一元的に処理可能
- **負荷分散**：様々な負荷分散アルゴリズムをサポート